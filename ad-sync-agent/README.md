# AD Sync Agent

–ê–≥–µ–Ω—Ç –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ Active Directory —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π ServiceDesk.

## üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢ (–¥–ª—è Windows)

1. **–†–∞—Å–ø–∞–∫—É–π—Ç–µ ZIP —Ñ–∞–π–ª** –≤ –ª—é–±—É—é –ø–∞–ø–∫—É
2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ `setup-windows.bat`** - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. **–û—Ç–∫—Ä–æ–π—Ç–µ `.env.example`**, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ, **—Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ `.env`**
4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ `START.bat`** - –∞–≥–µ–Ω—Ç –Ω–∞—á–Ω–µ—Ç —Ä–∞–±–æ—Ç—É!

**–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ:** –æ—Ç–∫—Ä–æ–π—Ç–µ `INSTALL.md` –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π.

---

## üì¶ –î–µ—Ç–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ì–æ—Ç–æ–≤—ã–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –°–∫–∞—á–∞–π—Ç–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –¥–ª—è –≤–∞—à–µ–π –û–°:
   - **Windows**: `ad-sync-agent-windows-amd64.exe`
   - **Linux**: `ad-sync-agent-linux-amd64`
   - **macOS (Intel)**: `ad-sync-agent-darwin-amd64`
   - **macOS (Apple Silicon)**: `ad-sync-agent-darwin-arm64`

2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` —Ä—è–¥–æ–º —Å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º —Ñ–∞–π–ª–æ–º:
   - Windows: —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –∏ –ø–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –≤ `.env`
   - Linux/macOS: `cp .env.example .env`

3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `.env` —Ñ–∞–π–ª —Å –≤–∞—à–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª:
   - Windows: –¥–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –Ω–∞ `ad-sync-agent-windows-amd64.exe` –∏–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
   - Linux: `chmod +x ad-sync-agent-linux-amd64 && ./ad-sync-agent-linux-amd64`
   - macOS: `chmod +x ad-sync-agent-darwin-amd64 && ./ad-sync-agent-darwin-amd64`

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ (Python)

–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –≤–µ—Ä—Å–∏—è –Ω–∞ Python:

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python 3.8 –∏–ª–∏ –≤—ã—à–µ
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env`:
```bash
cp .env.example .env
```

4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `.env` —Ñ–∞–π–ª —Å –≤–∞—à–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: `python ad_sync_agent.py`

### –í–∞—Ä–∏–∞–Ω—Ç 3: –°–±–æ—Ä–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞

**–í–∞—Ä–∏–∞–Ω—Ç 3a: –°–±–æ—Ä–∫–∞ –∏–∑ Go (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ–π —Å–±–æ—Ä–∫–∏)**

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —Å–æ–±—Ä–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –∏–∑ Go:

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [Go](https://go.dev/dl/) 1.21 –∏–ª–∏ –≤—ã—à–µ
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∫–∏:
   - Linux/macOS: `bash build.sh`
   - Windows: `build.bat`
3. –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –≤ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

**–í–∞—Ä–∏–∞–Ω—Ç 3b: –°–±–æ—Ä–∫–∞ –∏–∑ Python (PyInstaller)**

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å Python, –Ω–æ –Ω–µ—Ç Go:

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python 3.8 –∏–ª–∏ –≤—ã—à–µ
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `pip install -r requirements.txt`
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PyInstaller: `pip install pyinstaller`
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∫–∏:
   - Linux/macOS: `bash build-pyinstaller.sh`
   - Windows: `build-pyinstaller.bat`
5. –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –≤ –ø–∞–ø–∫–µ `dist/`

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Active Directory
- `AD_HOST` - –∞–¥—Ä–µ—Å AD —Å–µ—Ä–≤–µ—Ä–∞ (ldap://server:389 –∏–ª–∏ ldaps://server:636)
- `AD_USERNAME` - —É—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ AD
- `AD_PASSWORD` - –ø–∞—Ä–æ–ª—å –¥–ª—è —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏
- `AD_BASE_DN` - –±–∞–∑–æ–≤—ã–π DN (–Ω–∞–ø—Ä–∏–º–µ—Ä, DC=domain,DC=local)
- `AD_USER_SEARCH_BASE` - DN –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, CN=Users,DC=domain,DC=local)
- `AD_USER_SEARCH_FILTER` - —Ñ–∏–ª—å—Ç—Ä –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: (objectClass=user))
- `AD_USE_SSL` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SSL (true/false)

### –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞
- `PLATFORM_URL` - URL –≤–∞—à–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (https://your-platform.com)
- `TENANT_ID` - ID –≤–∞—à–µ–≥–æ —Ç–µ–Ω–∞–Ω—Ç–∞ (–º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã)
- `API_KEY` - API –∫–ª—é—á –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö AD Sync –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ)

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- `SYNC_INTERVAL` - –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 3600 = 1 —á–∞—Å)

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞

**Windows:**
- –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ `ad-sync-agent-windows-amd64.exe`
- –ò–ª–∏ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏: `ad-sync-agent-windows-amd64.exe`

**Linux:**
```bash
./ad-sync-agent-linux-amd64
```

**macOS:**
```bash
./ad-sync-agent-darwin-amd64
```

### –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ

**Linux:**
```bash
nohup ./ad-sync-agent-linux-amd64 > ad_sync.log 2>&1 &
```

**Windows (–∫–∞–∫ —Å–ª—É–∂–±–∞):**
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Task Scheduler –∏–ª–∏ NSSM –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–∞–∫ —Å–ª—É–∂–±—ã:
```cmd
nssm install ADSyncAgent "C:\path\to\ad-sync-agent-windows-amd64.exe"
nssm start ADSyncAgent
```

**macOS (–∫–∞–∫ —Å–ª—É–∂–±–∞):**
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `launchd` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–∞–∫ —Å–ª—É–∂–±—ã.

### –ó–∞–ø—É—Å–∫ Python –≤–µ—Ä—Å–∏–∏
```bash
python ad_sync_agent.py
```

## –õ–æ–≥–∏

- –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª: –ª–æ–≥–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å
- Python –≤–µ—Ä—Å–∏—è: –ª–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª `ad_sync.log` –∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å

## –ü–ª–∞—Ç—Ñ–æ—Ä–º—ã

–ê–≥–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º:
- ‚úÖ Windows (amd64)
- ‚úÖ Linux (amd64)
- ‚úÖ macOS (Intel –∏ Apple Silicon)

–í—Å–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã –Ω–µ —Ç—Ä–µ–±—É—é—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ü–û - –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∏ —Ä–∞–±–æ—Ç–∞–π—Ç–µ!

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ**: 
- –•—Ä–∞–Ω–∏—Ç–µ `.env` —Ñ–∞–π–ª –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` —Ñ–∞–π–ª –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ AD
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –¥–ª—è `PLATFORM_URL` –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

## –°–±–æ—Ä–∫–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤

–ï—Å–ª–∏ –Ω—É–∂–Ω—ã –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º –∏–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã —Å–±–æ—Ä–∫–∏:

**Go (–∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è —Å–±–æ—Ä–∫–∞):**
- Linux/macOS: `bash build.sh`
- Windows: `build.bat`

**Python (PyInstaller):**
- Linux/macOS: `bash build-pyinstaller.sh`
- Windows: `build-pyinstaller.bat`

**–í–∞–∂–Ω–æ:**
- Go –≤–µ—Ä—Å–∏—è —Å–æ–∑–¥–∞—Å—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º (Windows, Linux, macOS)
- PyInstaller –≤–µ—Ä—Å–∏—è —Å–æ–∑–¥–∞—Å—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ–∫—É—â–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –≤ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (Go) –∏–ª–∏ –≤ –ø–∞–ø–∫–µ `dist/` (PyInstaller)

